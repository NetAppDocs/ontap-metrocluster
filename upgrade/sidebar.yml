section: upgrade
title: Upgrade, refresh, or expand the MetroCluster configuration
entries:
  - title: Start here - Choose your procedure
    entries:
    - title: Choose controller upgrade, system refresh, or expansion
      url: "/upgrade/concept_choosing_an_upgrade_method_mcc.html"
    - title: Choose controller upgrade procedure
      url: "/upgrade/concept_choosing_controller_upgrade_mcc.html"
    - title: Choose system refresh procedure
      url: "/upgrade/concept_choosing_tech_refresh_mcc.html"
    - title: Choose expansion procedure
      url: "/upgrade/concept_choosing_expansion_method_mcc.html"
  - title: Upgrade controllers in four-node MetroCluster IP using switchover and switchback with "system controller replace" commands (ONTAP 9.13.1 and later)
    entries:
    - title: Upgrade workflow
      url: "/upgrade/upgrade-mcc-ip-system-controller-replace.html"
    - title: Prepare to upgrade
      entries:
      - title: Supported MetroCluster IP controller upgrades using "system controller replace" commands
        url:  "/upgrade/upgrade-mcc-ip-system-controller-replace-supported-platforms.html"
      - title: Requirements for using this upgrade procedure
        url: "/upgrade/upgrade-mcc-ip-system-controller-replace-requirements.html"
      - title: Enable console logging
        url:  "/upgrade/upgrade-mcc-ip-system-controller-replace-console-logging.html"
      - title: Set the required bootarg on the existing system (only on systems introduced in 9.15.1 or later)
        url: "/upgrade/upgrade-mcc-ip-system-controller-replace-set-bootarg.html"
      - title: Prepare the system for upgrade
        url: "/upgrade/upgrade-mcc-ip-system-controller-replace-prechecks.html"
    - title: Upgrade controllers using "system controller replace" commands 
      entries:
      - title: Prepare the network configuration of the old controllers
        url: "/upgrade/upgrade-mcc-ip-system-controller-replace-prepare-network-configuration.html"
      - title: Set up and netboot the new controllers
        url: "/upgrade/upgrade-mcc-ip-system-controller-replace-setup-new-controllers.html"
      - title: Restore the HBA configuration and set the HA state
        url: "/upgrade/upgrade-mcc-ip-system-controller-replace-restore-hba-set-ha.html"
      - title: Update the switch RCF files and set the MetroCluster IP bootarg values
        url: "/upgrade/upgrade-mcc-ip-system-controller-replace-apply-rcf-set-bootarg.html"
      - title: Reassign root aggregate disks
        url: "/upgrade/upgrade-mcc-ip-system-controller-replace-reassign-root-agg.html"
      - title: Boot up the new controllers
        url: "/upgrade/upgrade-mcc-ip-system-controller-replace-boot-new-controllers.html"
    - title: Complete the controller upgrade
      url: "/upgrade/upgrade-mcc-ip-system-controller-replace-complete-upgrade.html"
  - title: Upgrade controllers in MetroCluster IP using switchover and switchback (ONTAP 9.8 and later)
    entries:
    - title: Upgrade workflow
      url: "/upgrade/upgrade-mcc-ip-manual.html"
    - title: Prepare to upgrade
      entries:
      - title: Requirements for using this upgrade procedure
        url: "/upgrade/upgrade-mcc-ip-manual-requirements.html"
      - title: Enable console logging
        url:  "/upgrade/upgrade-mcc-ip-manual-console-logging.html"
      - title: Set the required bootarg on the existing system (only on systems introduced in 9.15.1 or later)
        url: "/upgrade/upgrade-mcc-ip-manual-set-bootarg.html"
      - title: Prepare the system for upgrade
        url: "/upgrade/upgrade-mcc-ip-prepare-system.html"
    - title: Upgrade controllers using switchover and switchback
      entries: 
      - title: Switchover the MetroCluster configuration
        url: "/upgrade/upgrade-mcc-ip-manual-switchover.html"
      - title: Remove interface configurations and uninstall the old controllers
        url: "/upgrade/upgrade-mcc-ip-manual-uninstall-controllers.html"
      - title: Set up the new controllers
        url: "/upgrade/upgrade-mcc-ip-manual-setup-controllers.html"
      - title: Restore the HBA configuration and set the HA state
        url: "/upgrade/upgrade-mcc-ip-manual-hba-set-ha.html"
      - title: Update the switch RCF files and set the MetroCluster IP bootarg values
        url: "/upgrade/upgrade-mcc-ip-manual-apply-rcf-set-bootarg.html"
      - title: Reassign root aggregate disks
        url: "/upgrade/upgrade-mcc-ip-manual-reassign-root-agg.html"
      - title: Boot up the new controllers and restore LIF configuration
        url: "/upgrade/upgrade-mcc-ip-manual-boot-new-controllers.html"
      - title: Switchback the configuration
        url: "/upgrade/upgrade-mcc-ip-manual-switchback.html"
    - title: Complete the controller upgrade
      url: "/upgrade/upgrade-mcc-ip-manual-complete-upgrade.html"
  - title: Upgrade controllers (AFF A700/FAS9000 to AFF A900/FAS9500) in MetroCluster IP using switchover and switchback  (ONTAP 9.10.1 or later)
    entries:
    - title: Upgrade workflow
      url: "/upgrade/upgrade-mcc-ip-a700-fas9000.html"
    - title: Prepare to upgrade
      entries:
      - title: Requirements for using this upgrade procedure
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-requirements.html"
      - title: Enable console logging
        url:  "/upgrade/upgrade-mcc-ip-a700-fas9000-console-logging.html"
      - title: Prepare the system for upgrade
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-prepare-system.html"
    - title: Upgrade AFF A700 or FAS9000 controllers using switchover and switchback
      entries: 
      - title: Switchover the MetroCluster configuration
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-switchover.html"
      - title: Remove the AFF A700 or FAS9000 controller modules and NVS
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-remove-modules-nvs.html"
      - title: Install the AFF A900 or FAS9500 NVS and controller modules
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-install-modules-nvs.html"
      - title: Restore the HBA configuration and set the HA state
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-hba-set-ha.html"
      - title: Update the switch RCF files and set the MetroCluster IP bootarg values
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-apply-rcf-set-bootarg.html"
      - title: Reassign root aggregate disks
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-reassign-root-agg.html"
      - title: Boot up the new controllers and restore LIF configuration
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-boot-new-controllers.html"
      - title: Switchback the configuration
        url: "/upgrade/upgrade-mcc-ip-a700-fas9000-switchback.html"
    - title: Complete the controller upgrade
      url: "/upgrade/upgrade-mcc-ip-a700-fas9000-complete-upgrade.html"
  - title: Upgrade controllers in MetroCluster FC using switchover and switchback
    url: "/upgrade/task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.html"
  - title: Upgrade controllers (AFF A700/FAS9000 to AFF A900/FAS9500) in a MetroCluster FC configuration using switchover and switchback (ONTAP 9.10.1 or later)
    url: "/upgrade/task_upgrade_A700_to_A900_in_a_four_node_mcc_fc_us_switchover_and_switchback.html"
  - title: Upgrade controllers in four-node MetroCluster FC using switchover and switchback with "system controller replace" commands (ONTAP 9.10.1 and later)
    url: "/upgrade/task_upgrade_controllers_system_control_commands_in_a_four_node_mcc_fc.html"
  - title: Refresh a four-node MetroCluster FC configuration
    url: "/upgrade/task_refresh_4n_mcc_fc.html"
  - title: Refresh a four-node or an eight-node MetroCluster IP configuration (ONTAP 9.8 and later)
    url: "/upgrade/task_refresh_4n_mcc_ip.html"
  - title: Expand a two-node MetroCluster FC configuration to a four-node configuration
    entries:
    - title: Overview
      url: "/upgrade/task_expand_a_two_node_mcc_fc_configuration_to_a_four_node_fc_configuration_supertask.html"
    - title: Enable console logging
      url: "/upgrade/task-enable-console-logging-expand-fc.html"
    - title: Verify the state of the MetroCluster configuration
      url: "/upgrade/task_verify_the_state_of_the_mcc_configuration_mcc_expansion.html"
    - title: Send a custom AutoSupport message before adding nodes to the MetroCluster configuration
      url: "/upgrade/task_send_a_custom_autosupport_message_before_add_nodes_to_the_mcc_configuration_2_node_to_4_node.html"
    - title: Zone for the new controller ports when adding a controller module in a fabric-attached MetroCluster configuration
      url: "/upgrade/task_zone_for_the_new_controller_ports_in_a_fabric_attached_mcc_configuration_four_node_expansion.html"
    - title: Add a new controller module to each cluster
      entries:
      - title: Overview
        url: "/upgrade/task_add_a_new_controller_to_each_cluster_mcc_expansion.html"
      - title: Prepare for the upgrade
        url: "/upgrade/task_prepare_for_the_upgrade_add_2nd_controller_to_create_ha_pair.html"
      - title: Clear the configuration on a controller module
        url: "/upgrade/task_clear_the_configuration_on_a_controller_module_mcc.html"
      - title: Prepare cluster ports on an existing controller module
        url: "/upgrade/task_prepare_cluster_ports_on_the_exist_controller.html"
      - title: Prepare the netboot server to download the image
        url: "/upgrade/task_prepare_the_netboot_server_cluster_mode.html"
      - title: Set the HA mode on the existing controller module
        url: "/upgrade/task_enable_the_ha_mode_on_the_exist_controller_mcc_when_add_a_2nd_controller.html"
      - title: Shut down the existing controller module
        url: "/upgrade/task_shut_down_the_exist_controller_when_add_a_2nd_controller_in_c_mode.html"
      - title: Install and cable the new controller module
        entries:
        - title: Prerequisites and installation
          url: "/upgrade/task_install_and_cable_the_new_controller.html"
        - title: Cable the new controller module's FC-VI and HBA ports to the FC switches
          url: "/upgrade/task_cable_the_controller_module_s_fc_vi_hba_ports_to_the_fc_switches_controller_to_fc_sw.html"
        - title: Cabling the new controller module's cluster peering connections
          url: "/upgrade/task_cable_the_cluster_peering_connections.html"
      - title: Power up both controller modules and displaying the LOADER prompt
        url: "/upgrade/task_power_up_both_controller_modules_and_display_the_loader_prompt_2_node_mcc_expansion.html"
      - title: Change the ha-config setting on the existing and new controller modules
        url: "/upgrade/task_change_the_ha_config_setts_mcc_add_a_2nd_controller.html"
      - title: Set the partner system ID for both controller modules
        url: "/upgrade/task_set_the_partner_system_id_for_both_controller_modules.html"
      - title: Boot the existing controller module
        url: "/upgrade/task_boot_the_exist_controller_module.html"
      - title: Assign disks to the new controller module
        url: "/upgrade/task_assign_disks_to_the_new_controller_mcc_expansion.html"
      - title: Netboot and set up ONTAP on the new controller module
        url: "/upgrade/task_netboot_and_set_up_ontap_on_the_new_controller_module_mcc.html"
      - title: Mirror the root aggregate on the new controller
        url: "/upgrade/task_mirror_the_root_aggregates_mcc_expansion_procedure.html"
      - title: Configure intercluster LIFs
        url: "/upgrade/task-configure-intercluster-lifs.html"
      - title: Create a mirrored data aggregate on each node
        url: "/upgrade/task_create_a_mirrored_data_aggregate_on_each_node_mcc.html"
      - title: Install licenses for the new controller module
        url: "/upgrade/task_install_licenses_on_the_new_controller_module_cluster_mode.html"
      - title: Create unmirrored data aggregates
        url: "/upgrade/task_create_unmirrored_data_aggregates_mcc.html"
      - title: Install the firmware after adding a controller module
        url: "/upgrade/task_install_firmware_after_add_a_controller_module.html"
    - title: Refresh the MetroCluster configuration with new controllers
      url: "/upgrade/task_refresh_the_mcc_configuration_mcc_configure_refresh.html"
    - title: Enable storage failover on both controller modules and enable cluster HA
      url: "/upgrade/task_enable_storage_failover_both_controller_modules_and_set_cluster_ha.html"
    - title: Restart the SVMs
      url: "/upgrade/task_restart_the_svms.html"
  - title: Expand a four-node MetroCluster FC configuration to an eight-node configuration
    entries:
    - title: Overview
      url: "/upgrade/task_expand_a_four_node_mcc_fc_configuration_to_an_eight_node_configuration.html"
    - title: Enable console logging
      url: "/upgrade/task-enable-console-logging-expand-fc-four-node.html"
    - title: Determining the new cable layout
      url: "/upgrade/task_determin_the_new_cable_layout_mcc_expansion.html"
    - title: Rack the new equipment
      url: "/upgrade/task_rack_the_new_equipment_mcc_expansion.html"
    - title: Verify the health of the MetroCluster configuration
      url: "/upgrade/task_verify_the_health_of_the_mcc_configuration.html"
    - title: Check for MetroCluster configuration errors with Config Advisor
      url: "/upgrade/task_check_for_mcc_configuration_errors_with_config_advisor.html"
    - title: Send a custom AutoSupport message prior to add nodes to the MetroCluster configuration
      url: "/upgrade/task_send_a_custom_autosupport_message_before_add_nodes_to_the_mcc_configuration.html"
    - title: Recable and zone a switch fabric for the new nodes
      entries:
      - title: Disconnect the existing DR group from the fabric
        url: "/upgrade/task_disconnect_the_exist_dr_group_mcc_expansion.html"
      - title: Recable and reconfigure the switches
        url: "/upgrade/task_apply_the_rcf_files_and_recable_the_switches.html"
    - title: Configure ONTAP on the new controllers
      entries:
      - title: Clear the configuration on a controller module
        url: "/upgrade/task_clear_the_configuration_on_a_controller_module_mcc.html"
      - title: Assign disk ownership in AFF systems
        url: "/upgrade/task_assign_disk_ownership_in_aff_systems_mcc.html"
      - title: Assign disk ownership in non-AFF systems
        url: "/upgrade/task_assign_disk_ownership_to_non_aff_systems_mcc.html"
      - title: Verify the ha-config state of components
        url: "/upgrade/task_verify_that_the_ha_state_of_components_is_mcc_dr_smok_crater_or_mcc_expansion.html"
      - title: Boot the new controllers and join them to the cluster
        url: "/upgrade/task_boot_the_new_controllers_and_join_them_to_the_cluster.html"
      - title: Configure the clusters into a MetroCluster configuration
        entries:
        - title: Configure intercluster LIFs
          url: "/upgrade/task-configure-intercluster-lifs-4node.html"
        - title: Mirror the root aggregates
          url: "/upgrade/task_mirror_the_root_aggregates_mcc.html"
        - title: Implement the MetroCluster configuration
          url: "/upgrade/task_implement_the_mcc_configuration_mcc_refresh_mcc_expansion.html"
        - title: Create a mirrored data aggregate on each node
          url: "/upgrade/task_create_a_mirrored_data_aggregate_on_each_node_mcc.html"
        - title: Configure FC-to-SAS bridges for health monitoring
          url: "/upgrade/task_configure_the_fc_to_sas_bridges_for_health_monitor.html"
        - title: Move a metadata volume in MetroCluster configurations
          url: "/upgrade/task_move_a_metadata_volume_in_mcc_configurations.html"
        - title: Check the MetroCluster configuration
          url: "/upgrade/task_check_the_mcc_configuration.html"
    - title: Check for MetroCluster configuration errors with Config Advisor
      url: "/upgrade/task_check_for_mcc_configuration_errors_with_config_advisor.html"
    - title: Send a custom AutoSupport message after to add nodes to the MetroCluster configuration
      url: "/upgrade/task_send_a_custom_autosupport_message_after_add_nodes_to_the_mcc_configuration.html"
    - title: Verify switchover, healing, and switchback
      url: "/upgrade/task_verify_switchover_heal_and_switchback.html"
  - title: Expand a MetroCluster IP configuration 
    url: "/upgrade/task_expand_a_four_node_mcc_ip_configuration.html"
  - title: Remove a Disaster Recovery group
    url: "/upgrade/concept_removing_a_disaster_recovery_group.html"
  - title: Where to find additional information
    url: "/upgrade/reference_where_to_find_additional_information_mcc_ug.html"
