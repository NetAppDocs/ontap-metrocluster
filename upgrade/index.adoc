---
permalink: upgrade/index.html
sidebar: sidebar
keywords: 
summary: ''
---
= MetroClusterÂ® Upgrade, Transition, and Expansion Guide
:icons: font
:imagesdir: ../media/

* xref:concept_choosing_an_upgrade_method_mcc.adoc[Choosing an upgrade or refresh method]
* link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu[Upgrading controllers in a MetroCluster FC configuration using switchover and switchback]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_prepare_for_the_upgrade_mcc_fc_cu[Preparing for the upgrade]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_verify_the_health_of_the_mcc_configuration_mcc_fc_4n_cu[Verifying the health of the MetroCluster configuration]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_mapp_ports_from_the_old_node_to_the_new_node_mcc_fc_cu[Mapping ports from the old nodes to the new nodes]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_gather_information_before_the_upgrade_mcc_fc_4n_cu[Gathering information before the upgrade]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_remove_the_exist_configuration_from_tiebreaker_monitor_mcc_fc_cu[Removing the existing configuration from the Tiebreaker or other monitoring software]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_send_a_custom_autosupport_message_before_maintenance_mcc[Sending a custom AutoSupport message prior to maintenance]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_switch_over_to_site_a_mcc_fc_4n_cu[Switching over the MetroCluster configuration]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_prepare_the_network_configuration_of_the_old_controllers_mcc_fc_cu[Preparing the network configuration of the old controllers]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_remove_the_old_controllers_mcc_fc_4n_cu[Removing the old platforms]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_configure_the_new_controllers_mcc_fc_cu[Configuring the new controllers]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_set_up_the_new_controllers_mcc_fc_4n_cu[Setting up the new controllers]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_netboot_the_new_controllers_mcc_fc_4n_cu[Netbooting the new controllers]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_clear_the_configuration_on_a_controller_module_mcc[Clearing the configuration on a controller module]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_restore_the_hba_configuration_mcc_ip_4n_cu[Restoring the HBA configuration]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_set_the_ha_state_on_the_new_controllers_mcc_fc_4n_cu[Setting the HA state on the new controllers and chassis]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_reassign_root_aggregate_disks_mcc_fc_4n[Reassigning root aggregate disks]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_reboot_the_new_controllers_mcc_fc_4n_cu[Booting up the new controllers]
  *** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_verify_lif_configuration_mcc_fc_4n_cu[Verifying LIF configuration]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_switch_back_the_nodes_mcc_fc_4n_cu[Switching back the MetroCluster configuration]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_check_the_mcc_health_mcc_fc_4n_cu[Checking the health of the MetroCluster configuration]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_perform_the_upgrade_on_cluster_a_mcc_fc_4n_cu[Upgrading the nodes on cluster_A]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_send_a_custom_autosupport_message_after_maintenance_mcc_fc_cu[Sending a custom AutoSupport message after maintenance]
 ** link:task_upgrade_controllers_in_a_four_node_fc_mcc_us_switchover_and_switchback_mcc_fc_4n_cu.md#task_restore_tiebreaker_monitor_mcc_fc_4n_cu[Restoring Tiebreaker monitoring]
* link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip[Upgrading controllers in a MetroCluster IP configuration using switchover and switchback (ONTAP 9.8 and later)]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#concept_workflow_for_upgrading_controllers_in_an_mcc_ip_configuration[Workflow for upgrading controllers in an MetroCluster IP configuration]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_prepare_for_the_upgrade_mcc_ip_cu[Preparing for the upgrade]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_update_the_switch_rcf_files_before_upgrade_mcc_ip_cu[Updating the MetroCluster switch RCF files before upgrading controllers]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_mapp_ports_from_the_old_node_to_the_new_node_mcc_ip_cu[Mapping ports from the old nodes to the new nodes]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_netboot_the_new_controllers_mcc_ip_4n_cu[Netbooting the new controllers]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_clear_the_configuration_on_a_controller_module_mcc[Clearing the configuration on a controller module]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_verify_the_health_of_the_mcc_configuration_mcc_ip_4n_cu[Verifying MetroCluster health before site upgrade]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_gather_information_before_the_upgrade_mcc_ip_4n_cu[Gathering information before the upgrade]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_remove_mediator_or_tiebreaker_monitor[Removing Mediator or Tiebreaker monitoring]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_send_a_custom_autosupport_message_before_maintenance_mcc_ip_4n_cu[Sending a custom AutoSupport message prior to maintenance]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_switch_over_to_site_a_mcc_ip_4n_cu[Switching over the MetroCluster configuration]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_remove_the_old_controllers_mcc_ip_4n_cu[Removing interface configurations and uninstalling the old controllers]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_update_the_switch_rcfs_mcc_ip_4n_cu[Updating the switch RCFs to accommodate the new platforms]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_configure_the_new_controllers_mcc_ip_cu[Configuring the new controllers]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_set_up_the_new_controllers_mcc_ip_4n_cu[Setting up the new controllers]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_restore_the_hba_configuration_mcc_ip_4n_cu[Restoring the HBA configuration]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_set_the_ha_state_on_the_new_controllers_mcc_ip_4n_cu[Setting the HA state on the new controllers and chassis]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_set_the_mcc_ip_bootarg_variables[Setting the MetroCluster IP bootarg variables]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_reassign_root_aggregate_disks_mcc_ip_4n[Reassigning root aggregate disks]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_boot_up_the_new_controllers_mcc_ip_4n_cu[Booting up the new controllers]
  *** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_verify_lif_configuration_mcc_ip_4n_cu[Verifying and restoring LIF configuration]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_switch_back_the_nodes_mcc_ip_4n_cu[Switching back the MetroCluster configuration]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_check_the_mcc_health_mcc_ip_4n_cu[Checking the health of the MetroCluster configuration]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_perform_the_upgrade_on_cluster_a_mcc_ip_4n_cu[Upgrading the nodes on cluster_A]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_restore_tiebreaker_monitor_mcc_ip_4n_cu[Restoring Tiebreaker or Mediator monitoring]
 ** link:task_upgrade_controllers_in_a_four_node_ip_mcc_us_switchover_and_switchback_mcc_ip.md#task_send_a_custom_autosupport_message_after_maintenance_mcc_ip_4n_cu[Sending a custom AutoSupport message after maintenance]
* xref:task_refresh_controllers_in_a_four_node_mcc_fc_configuration.adoc[Refreshing a four-node MetroCluster FC configuration]
* link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#task_refresh_a_four_node_mcc_configuration_us_volume_move[Refreshing a four-node MetroCluster IP configuration (ONTAP 9.8 and later)]
 ** link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#task_add_new_nodes_to_the_mcc_ip_configuration_mcc_ip_expansion[Adding new nodes to the MetroCluster IP configuration]
  *** link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#concept_example_naming_in_this_procedure_mcc_ip_expansion[Example naming in this procedure]
  *** link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#task_send_a_custom_autosupport_message_before_maintenance_mcc_ip_expansion[Sending a custom AutoSupport message prior to maintenance]
  *** link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#task_verify_the_heath_of_the_mcc_configuration_mcc_ip_expansion[Verifying the health of the MetroCluster configuration]
  *** link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#task_remove_the_configuration_from_monitor_applications_mcc_ip_refresh[Removing the configuration from monitoring applications]
  *** link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#task_prepare_the_new_controllers_mcc_ip_expansion[Preparing the new controller modules]
  *** link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#task_add_the_new_nodes_to_the_mcc_ip_configuration_mcc_ip_expansion[Joining the new nodes to the clusters]
  *** link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#task_configure_cluster_peering_lifs_create_the_mcc_interfaces_and_mirror_root_aggregates_mcc_ip_expansion[Configuring intercluster LIFs, creating the MetroCluster interfaces, and mirroring root aggregates]
  *** link:task_refresh_a_four_node_mcc_configuration_us_volume_move.md#task_finalize_the_addition_of_the_new_nodes_mcc_ip_expansion[Finalizing the addition of the new nodes]
* xref:task_expand_a_two_node_mcc_fc_configuration_to_a_four_node_fc_configuration_supertask.adoc[Expanding a two-node MetroCluster FC configuration to a four-node configuration]
 ** xref:task_verify_the_state_of_the_mcc_configuration_mcc_expansion.adoc[Verifying the state of the MetroCluster configuration]
 ** xref:task_send_a_custom_autosupport_message_before_add_nodes_to_the_mcc_configuration_2_node_to_4_node.adoc[Sending a custom AutoSupport message before adding nodes to the MetroCluster configuration]
 ** xref:task_zone_for_the_new_controller_ports_in_a_fabric_attached_mcc_configuration_four_node_expansion.adoc[Zoning for the new controller ports when adding a controller module in a fabric-attached MetroCluster configuration]
 ** xref:task_add_a_new_controller_to_each_cluster_mcc_expansion.adoc[Adding a new controller module to each cluster]
  *** xref:task_prepare_for_the_upgrade_add_2nd_controller_to_create_ha_pair.adoc[Preparing for the upgrade]
  *** xref:task_clear_the_configuration_on_a_controller_module_mcc.adoc[Clearing the configuration on a controller module]
  *** xref:task_prepare_cluster_ports_on_the_exist_controller.adoc[Preparing cluster ports on an existing controller module]
  *** xref:task_prepare_the_netboot_server_cluster_mode.adoc[Preparing the netboot server to download the image]
  *** xref:task_enable_the_ha_mode_on_the_exist_controller_mcc_when_add_a_2nd_controller.adoc[Setting the HA mode on the existing controller module]
  *** xref:task_shut_down_the_exist_controller_when_add_a_2nd_controller_in_c_mode.adoc[Shutting down the existing controller module]
  *** xref:task_install_and_cable_the_new_controller.adoc[Installing and cabling the new controller module]
   **** xref:task_cable_the_controller_module_s_fc_vi_hba_ports_to_the_fc_switches_controller_to_fc_sw.adoc[Cabling the new controller module's FC-VI and HBA ports to the FC switches]
   **** xref:task_cable_the_cluster_peering_connections.adoc[Cabling the new controller module's cluster peering connections]
  *** xref:task_power_up_both_controller_modules_and_display_the_loader_prompt_2_node_mcc_expansion.adoc[Powering up both controller modules and displaying the LOADER prompt]
  *** xref:task_change_the_ha_config_setts_mcc_add_a_2nd_controller.adoc[Changing the ha-config setting on the existing and new controller modules]
  *** xref:task_set_the_partner_system_id_for_both_controller_modules.adoc[Setting the partner system ID for both controller modules]
  *** xref:task_boot_the_exist_controller_module.adoc[Booting the existing controller module]
  *** xref:task_assign_disks_to_the_new_controller_mcc_expansion.adoc[Assigning disks to the new controller module]
  *** xref:task_netboot_and_set_up_ontap_on_the_new_controller_module_mcc.adoc[Netbooting and setting up ONTAP on the new controller module]
  *** xref:task_mirror_the_root_aggregates_mcc_expansion_procedure.adoc[Mirroring the root aggregate on the new controller]
  *** xref:task_configure_intercluster_lifs.adoc[Configuring intercluster LIFs]
   **** xref:task_configure_intercluster_lifs_to_use_dedicated_intercluster_ports.adoc[Configuring intercluster LIFs on dedicated ports]
   **** xref:task_configure_intercluster_lifs_to_share_data_ports.adoc[Configuring intercluster LIFs on shared data ports]
  *** xref:task_create_a_mirrored_data_aggregate_on_each_node_mcc.adoc[Creating a mirrored data aggregate on each node]
  *** xref:task_install_licenses_on_the_new_controller_module_cluster_mode.adoc[Installing licenses for the new controller module]
  *** xref:task_create_unmirrored_data_aggregates_mcc.adoc[Creating unmirrored data aggregates]
  *** xref:task_install_firmware_after_add_a_controller_module.adoc[Installing the firmware after adding a controller module]
 ** xref:task_refresh_the_mcc_configuration_mcc_configure_refresh.adoc[Refreshing the MetroCluster configuration with new controllers]
 ** xref:task_enable_storage_failover_both_controller_modules_and_set_cluster_ha.adoc[Enabling storage failover on both controller modules and enabling cluster HA]
 ** xref:task_restart_the_svms.adoc[Restarting the SVMs]
* xref:task_expand_a_four_node_mcc_fc_configuration_to_an_eight_node_configuration.adoc[Expanding a four-node MetroCluster FC configuration to an eight-node configuration]
 ** xref:task_determin_the_new_cable_layout_mcc_expansion.adoc[Determining the new cabling layout]
 ** xref:task_rack_the_new_equipment_mcc_expansion.adoc[Racking the new equipment]
 ** xref:task_verify_the_health_of_the_mcc_configuration.adoc[Verifying the health of the MetroCluster configuration]
 ** xref:task_check_for_mcc_configuration_errors_with_config_advisor.adoc[Checking for MetroCluster configuration errors with Config Advisor]
 ** xref:task_send_a_custom_autosupport_message_before_add_nodes_to_the_mcc_configuration.adoc[Sending a custom AutoSupport message prior to adding nodes to the MetroCluster configuration]
 ** xref:task_recable_and_zone_a_switch_fabric_mcc_expansion.adoc[Recabling and zoning a switch fabric for the new nodes]
  *** xref:task_disconnect_the_exist_dr_group_mcc_expansion.adoc[Disconnecting the existing DR group from the fabric]
  *** xref:task_apply_the_rcf_files_and_recable_the_switches.adoc[Applying the RCF files and recabling the switches]
 ** xref:task_configure_ontap_on_the_new_controllers_mcc_expansion.adoc[Configuring ONTAP on the new controllers]
  *** xref:task_clear_the_configuration_on_a_controller_module_mcc.adoc[Clearing the configuration on a controller module]
  *** xref:task_assign_disk_ownership_in_aff_systems_mcc.adoc[Assigning disk ownership in AFF systems]
  *** xref:task_assign_disk_ownership_to_non_aff_systems_mcc.adoc[Assigning disk ownership in non-AFF systems]
  *** xref:task_verify_that_the_ha_state_of_components_is_mcc_dr_smok_crater_or_mcc_expansion.adoc[Verifying the ha-config state of components]
  *** xref:task_boot_the_new_controllers_and_join_them_to_the_cluster.adoc[Booting the new controllers and joining them to the cluster]
  *** xref:task_configure_the_clusters_into_a_mcc_configuration.adoc[Configuring the clusters into a MetroCluster configuration]
   **** xref:task_configure_intercluster_lifs.adoc[Configuring intercluster LIFs]
    ***** xref:task_configure_intercluster_lifs_to_use_dedicated_intercluster_ports.adoc[Configuring intercluster LIFs on dedicated ports]
    ***** xref:task_configure_intercluster_lifs_to_share_data_ports.adoc[Configuring intercluster LIFs on shared data ports]
   **** xref:task_mirror_the_root_aggregates_mcc.adoc[Mirroring the root aggregates]
   **** xref:task_implement_the_mcc_configuration_mcc_refresh_mcc_expansion.adoc[Implementing the MetroCluster configuration]
   **** xref:task_create_a_mirrored_data_aggregate_on_each_node_mcc.adoc[Creating a mirrored data aggregate on each node]
   **** xref:task_configure_the_fc_to_sas_bridges_for_health_monitor.adoc[Configuring FC-to-SAS bridges for health monitoring]
   **** xref:task_move_a_metadata_volume_in_mcc_configurations.adoc[Moving a metadata volume in MetroCluster configurations]
   **** xref:task_check_the_mcc_configuration.adoc[Checking the MetroCluster configuration]
 ** xref:task_check_for_mcc_configuration_errors_with_config_advisor.adoc[Checking for MetroCluster configuration errors with Config Advisor]
 ** xref:task_send_a_custom_autosupport_message_after_add_nodes_to_the_mcc_configuration.adoc[Sending a custom AutoSupport message after to adding nodes to the MetroCluster configuration]
 ** xref:task_verify_switchover_heal_and_switchback.adoc[Verifying switchover, healing, and switchback]
* xref:concept_removing_a_disaster_recovery_group.adoc[Removing a Disaster Recovery group]
* xref:reference_where_to_find_additional_information_mcc_ug.adoc[Where to find additional information]
* xref:reference_copyright_and_trademark.adoc[Copyright, trademark, and machine translation]
 ** xref:reference_copyright.adoc[Copyright]
 ** xref:reference_trademark.adoc[Trademark]
 ** xref:generic_machine_translation_disclaimer.adoc[Machine translation]
